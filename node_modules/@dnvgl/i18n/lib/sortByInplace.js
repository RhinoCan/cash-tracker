import { compareNumbersAlike } from "./compareNumbersAlike";
import { compareStrings } from "./compareStrings";
import { resolveCollatorLocale } from "./internal/resolveCollatorLocale";
import { compareNotDefinedTypes } from "./internal/compareNotDefinedTypes";
export function sortByInplace(source, selectors, orders, locale) {
    var valueSelectors = Array.isArray(selectors)
        ? selectors
        : [selectors];
    var sortOrders = (orders !== undefined && !Array.isArray(orders))
        ? Array(valueSelectors.length).fill(orders)
        : orders;
    var collator = resolveCollatorLocale(locale);
    return source.sort(function (a, b) {
        for (var i = 0; i < valueSelectors.length; i++) {
            var selector = valueSelectors[i], sortValue = compareValues(a, b, selector, collator);
            if (sortValue !== 0) {
                var order = sortOrders === null || sortOrders === void 0 ? void 0 : sortOrders[i];
                return (order === "desc" || order === "descend")
                    ? -sortValue
                    : sortValue;
            }
        }
        return 0;
    });
    function compareValues(a, b, selector, collator) {
        var aValue = selector(a), bValue = selector(b), typeofSource = aValue !== null && aValue !== void 0 ? aValue : bValue;
        if (typeofSource == null) {
            return compareNotDefinedTypes(a, b);
        }
        if (typeof typeofSource === "string") {
            return compareStrings(aValue, bValue, collator);
        }
        return compareNumbersAlike(aValue, bValue);
    }
}
