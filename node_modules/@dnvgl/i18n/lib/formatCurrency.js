import { findIso4217Currency } from "./findIso4217Currency";
import { isCharAtoZUppercase } from "./internal/isCharAtoZUppercase";
var intlDisplayNamesCache = null, cachedLocale = undefined;
export function formatCurrency(currency, locale) {
    var _a, _b, _c;
    var currencyAlpha3Code = typeof currency === "string"
        ? (currency.length === 3
            && isCharAtoZUppercase(currency.charCodeAt(0))
            && isCharAtoZUppercase(currency.charCodeAt(1))
            && isCharAtoZUppercase(currency.charCodeAt(2)))
            ? currency
            : undefined
        : (_a = findIso4217Currency(currency)) === null || _a === void 0 ? void 0 : _a.alpha3Code;
    if (currencyAlpha3Code === undefined) {
        return returnUnsupportedCurrency(currency);
    }
    if (intlDisplayNamesCache === null || locale !== cachedLocale) {
        if (typeof Intl.DisplayNames === "undefined") {
            return (_c = (_b = findIso4217Currency(currency)) === null || _b === void 0 ? void 0 : _b.currencyName) !== null && _c !== void 0 ? _c : returnUnsupportedCurrency(currency);
        }
        intlDisplayNamesCache = new Intl.DisplayNames(locale, { type: "currency" });
        cachedLocale = locale;
    }
    return intlDisplayNamesCache.of(currencyAlpha3Code);
}
function returnUnsupportedCurrency(currency) {
    return typeof currency === "string" ? currency : "";
}
